/*
 * check_key_gen.c
 *
 *  Created on: Jun 13, 2018
 *      Author: vader
 */

#include "check_key_gen.h"
#if defined(TEST)
#if defined(DAGS_3) || defined(DAGS_5) || defined(DAGS_TOY)

START_TEST(build_signature_h_test)
	{
		gf correct_result[] = { 54793, 14489, 9408, 5528, 58383, 20522, 54398,
				45964, 9682, 46025, 24854, 52706, 37374, 28418, 40549, 17746,
				9964, 15791, 11154, 27441, 37231, 21068, 39812, 32502, 12306,
				65169, 52166, 47361, 58826, 21434, 39044, 13288, 39766, 57008,
				46040, 1431, 38855, 6906, 24449, 56736, 22662, 6157, 9060, 5558,
				65352, 15744, 48518, 41519, 10077, 26529, 15312, 34494, 12083,
				36378, 21097, 10595, 33630, 61108, 5464, 56789, 44288, 30986,
				30192, 7544 };

		gf dyadic_signature[code_length] = { 0 };
		gf omega[1] = { 0 };
		gf u[signature_block_size] = { 0 };
		gf v[code_length] = { 0 };

		build_dyadic_signature(dyadic_signature, omega);

		for (int i = 0; i < code_length; i++) {
			ck_assert_int_eq(dyadic_signature[i], correct_result[i]);
		}

		build_support(omega[0], dyadic_signature, u, v);

	}END_TEST

START_TEST(build_support_test)
	{
		gf correct_signature[] = { 61645, 33457, 52560, 6177, 48815, 45356,
				2898, 41890, 52274, 29734, 39434, 14559, 31685, 16410, 43112,
				46962, 1306, 35873, 8036, 52461, 32165, 4100, 28613, 64432,
				11593, 56823, 33982, 32137, 54659, 32696, 31656, 11720, 56052,
				36825, 53666, 29780, 10886, 24470, 42022, 205, 52784, 35418,
				50747, 62499, 3779, 37719, 48024, 36133, 60530, 32673, 52824,
				51040, 24328, 44832, 58334, 849, 46875, 8788, 14692, 21889,
				45560, 44854, 13854, 45245 };

		gf correct_u[] = { 56113, 47829, 47250, 55670 };
		gf correct_v[] = { 19551, 11707, 12284, 19992, 30161, 5173, 5746, 30614,
				15182, 23210, 22765, 14601, 32163, 7239, 7680, 32740, 27900,
				3352, 3935, 28347, 4925, 29401, 28830, 4474, 17306, 8830, 8249,
				16861, 36401, 61397, 60818, 35958, 24033, 15365, 15938, 24486,
				14823, 22531, 23108, 15264, 49113, 56893, 56442, 48542, 61489,
				37333, 37778, 62070, 58899, 34807, 34224, 58452, 14989, 23401,
				22830, 14538, 51304, 43404, 43979, 51759, 60522, 36238, 36809,
				60973 };
		gf omega[1] = { 19551 };
		gf u[signature_block_size] = { 0 };
		gf v[code_length] = { 0 };

		build_support(omega[0], correct_signature, u, v);

		for (int i = 0; i < code_length; i++) {
			ck_assert_int_eq(v[i], correct_v[i]);
		}
		for (int i = 0; i < signature_block_size; i++) {
			ck_assert_int_eq(u[i], correct_u[i]);
		}

	}END_TEST

START_TEST(build_cauchy_matrix_test)
	{

		gf correct_u[] = { 1392, 64041, 9227, 56146 };
		gf correct_v[] = { 63482, 2211, 54913, 10712, 52564, 12813, 60463, 4982,
				46987, 18642, 38640, 27049, 55444, 10189, 63983, 1718, 65146,
				291, 57089, 8280, 578, 64795, 9017, 56416, 23777, 41912, 32154,
				33475, 26179, 39194, 18232, 47201, 62132, 3565, 54223, 11414,
				21087, 44294, 29476, 35965, 21426, 44267, 29385, 36240, 43870,
				21511, 35365, 30076, 14304, 51385, 5787, 59842, 26119, 39262,
				18300, 47141, 21052, 44389, 29511, 35870, 50466, 14971, 58457,
				6912 };
		gf correct_data_cauchy[] = { 50853, 51485, 43423, 46511, 31162, 40974,
				26610, 35861, 38145, 7550, 54933, 26494, 55599, 6749, 33083,
				25235, 44806, 13934, 63472, 53380, 9311, 42471, 24399, 29083,
				40234, 34707, 16742, 30770, 22956, 32914, 40542, 31093, 51063,
				44537, 24448, 28415, 59818, 51377, 56799, 16533, 48820, 20468,
				57883, 46670, 20918, 40950, 4471, 65515, 13493, 12395, 15205,
				10271, 30020, 62189, 3637, 59578, 10041, 56820, 39489, 18284,
				8111, 1238, 5347, 32167, 51485, 50853, 46511, 43423, 40974,
				31162, 35861, 26610, 7550, 38145, 26494, 54933, 6749, 55599,
				25235, 33083, 13934, 44806, 53380, 63472, 42471, 9311, 29083,
				24399, 34707, 40234, 30770, 16742, 32914, 22956, 31093, 40542,
				44537, 51063, 28415, 24448, 51377, 59818, 16533, 56799, 20468,
				48820, 46670, 57883, 40950, 20918, 65515, 4471, 12395, 13493,
				10271, 15205, 62189, 30020, 59578, 3637, 56820, 10041, 18284,
				39489, 1238, 8111, 32167, 5347, 43423, 46511, 50853, 51485,
				26610, 35861, 31162, 40974, 54933, 26494, 38145, 7550, 33083,
				25235, 55599, 6749, 63472, 53380, 44806, 13934, 24399, 29083,
				9311, 42471, 16742, 30770, 40234, 34707, 40542, 31093, 22956,
				32914, 24448, 28415, 51063, 44537, 56799, 16533, 59818, 51377,
				57883, 46670, 48820, 20468, 4471, 65515, 20918, 40950, 15205,
				10271, 13493, 12395, 3637, 59578, 30020, 62189, 39489, 18284,
				10041, 56820, 5347, 32167, 8111, 1238, 46511, 43423, 51485,
				50853, 35861, 26610, 40974, 31162, 26494, 54933, 7550, 38145,
				25235, 33083, 6749, 55599, 53380, 63472, 13934, 44806, 29083,
				24399, 42471, 9311, 30770, 16742, 34707, 40234, 31093, 40542,
				32914, 22956, 28415, 24448, 44537, 51063, 16533, 56799, 51377,
				59818, 46670, 57883, 20468, 48820, 65515, 4471, 40950, 20918,
				10271, 15205, 12395, 13493, 59578, 3637, 62189, 30020, 18284,
				39489, 56820, 10041, 32167, 5347, 1238, 8111, 55088, 39801,
				48935, 40631, 1907, 62795, 13079, 18846, 28387, 12777, 65328,
				29511, 45949, 14245, 17527, 9707, 64514, 36656, 24332, 64597,
				42885, 41975, 58374, 2098, 25062, 595, 50275, 18206, 45671, 27,
				29807, 22310, 34329, 43491, 46163, 14379, 27244, 57092, 58541,
				37195, 37931, 35907, 9396, 51759, 47203, 12290, 14392, 21769,
				57025, 36165, 34504, 48661, 23479, 23712, 3125, 27457, 45832,
				57576, 30698, 50755, 24668, 21444, 31701, 1266, 39801, 55088,
				40631, 48935, 62795, 1907, 18846, 13079, 12777, 28387, 29511,
				65328, 14245, 45949, 9707, 17527, 36656, 64514, 64597, 24332,
				41975, 42885, 2098, 58374, 595, 25062, 18206, 50275, 27, 45671,
				22310, 29807, 43491, 34329, 14379, 46163, 57092, 27244, 37195,
				58541, 35907, 37931, 51759, 9396, 12290, 47203, 21769, 14392,
				36165, 57025, 48661, 34504, 23712, 23479, 27457, 3125, 57576,
				45832, 50755, 30698, 21444, 24668, 1266, 31701, 48935, 40631,
				55088, 39801, 13079, 18846, 1907, 62795, 65328, 29511, 28387,
				12777, 17527, 9707, 45949, 14245, 24332, 64597, 64514, 36656,
				58374, 2098, 42885, 41975, 50275, 18206, 25062, 595, 29807,
				22310, 45671, 27, 46163, 14379, 34329, 43491, 58541, 37195,
				27244, 57092, 9396, 51759, 37931, 35907, 14392, 21769, 47203,
				12290, 34504, 48661, 57025, 36165, 3125, 27457, 23479, 23712,
				30698, 50755, 45832, 57576, 31701, 1266, 24668, 21444, 40631,
				48935, 39801, 55088, 18846, 13079, 62795, 1907, 29511, 65328,
				12777, 28387, 9707, 17527, 14245, 45949, 64597, 24332, 36656,
				64514, 2098, 58374, 41975, 42885, 18206, 50275, 595, 25062,
				22310, 29807, 27, 45671, 14379, 46163, 43491, 34329, 37195,
				58541, 57092, 27244, 51759, 9396, 35907, 37931, 21769, 14392,
				12290, 47203, 48661, 34504, 36165, 57025, 27457, 3125, 23712,
				23479, 50755, 30698, 57576, 45832, 1266, 31701, 21444, 24668 };
		matrix H_cauchy;
		H_cauchy.rows = signature_block_size * extension;
		H_cauchy.cols = code_length;
		gf data_cauchy[signature_block_size * extension * code_length] = { 0 };
		H_cauchy.data = data_cauchy;

		build_cauchy_matrix(correct_u, correct_v, &H_cauchy);

		for (int i = 0; i < signature_block_size * extension; i++) {
			for (int j = 0; j < code_length; j++) {
				ck_assert_int_eq(H_cauchy.data[i * H_cauchy.cols + j],
						correct_data_cauchy[i * H_cauchy.cols + j]);
			}

		}

	}END_TEST

START_TEST(build_trapdoor_test)
	{

		gf correct_u[] = { 1392, 64041, 9227, 56146 };
		gf correct_v[] = { 63482, 2211, 54913, 10712, 52564, 12813, 60463, 4982,
				46987, 18642, 38640, 27049, 55444, 10189, 63983, 1718, 65146,
				291, 57089, 8280, 578, 64795, 9017, 56416, 23777, 41912, 32154,
				33475, 26179, 39194, 18232, 47201, 62132, 3565, 54223, 11414,
				21087, 44294, 29476, 35965, 21426, 44267, 29385, 36240, 43870,
				21511, 35365, 30076, 14304, 51385, 5787, 59842, 26119, 39262,
				18300, 47141, 21052, 44389, 29511, 35870, 50466, 14971, 58457,
				6912 };
		gf correct_data_cauchy[] = { 50853, 51485, 43423, 46511, 31162, 40974,
				26610, 35861, 38145, 7550, 54933, 26494, 55599, 6749, 33083,
				25235, 44806, 13934, 63472, 53380, 9311, 42471, 24399, 29083,
				40234, 34707, 16742, 30770, 22956, 32914, 40542, 31093, 51063,
				44537, 24448, 28415, 59818, 51377, 56799, 16533, 48820, 20468,
				57883, 46670, 20918, 40950, 4471, 65515, 13493, 12395, 15205,
				10271, 30020, 62189, 3637, 59578, 10041, 56820, 39489, 18284,
				8111, 1238, 5347, 32167, 51485, 50853, 46511, 43423, 40974,
				31162, 35861, 26610, 7550, 38145, 26494, 54933, 6749, 55599,
				25235, 33083, 13934, 44806, 53380, 63472, 42471, 9311, 29083,
				24399, 34707, 40234, 30770, 16742, 32914, 22956, 31093, 40542,
				44537, 51063, 28415, 24448, 51377, 59818, 16533, 56799, 20468,
				48820, 46670, 57883, 40950, 20918, 65515, 4471, 12395, 13493,
				10271, 15205, 62189, 30020, 59578, 3637, 56820, 10041, 18284,
				39489, 1238, 8111, 32167, 5347, 43423, 46511, 50853, 51485,
				26610, 35861, 31162, 40974, 54933, 26494, 38145, 7550, 33083,
				25235, 55599, 6749, 63472, 53380, 44806, 13934, 24399, 29083,
				9311, 42471, 16742, 30770, 40234, 34707, 40542, 31093, 22956,
				32914, 24448, 28415, 51063, 44537, 56799, 16533, 59818, 51377,
				57883, 46670, 48820, 20468, 4471, 65515, 20918, 40950, 15205,
				10271, 13493, 12395, 3637, 59578, 30020, 62189, 39489, 18284,
				10041, 56820, 5347, 32167, 8111, 1238, 46511, 43423, 51485,
				50853, 35861, 26610, 40974, 31162, 26494, 54933, 7550, 38145,
				25235, 33083, 6749, 55599, 53380, 63472, 13934, 44806, 29083,
				24399, 42471, 9311, 30770, 16742, 34707, 40234, 31093, 40542,
				32914, 22956, 28415, 24448, 44537, 51063, 16533, 56799, 51377,
				59818, 46670, 57883, 20468, 48820, 65515, 4471, 40950, 20918,
				10271, 15205, 12395, 13493, 59578, 3637, 62189, 30020, 18284,
				39489, 56820, 10041, 32167, 5347, 1238, 8111, 55088, 39801,
				48935, 40631, 1907, 62795, 13079, 18846, 28387, 12777, 65328,
				29511, 45949, 14245, 17527, 9707, 64514, 36656, 24332, 64597,
				42885, 41975, 58374, 2098, 25062, 595, 50275, 18206, 45671, 27,
				29807, 22310, 34329, 43491, 46163, 14379, 27244, 57092, 58541,
				37195, 37931, 35907, 9396, 51759, 47203, 12290, 14392, 21769,
				57025, 36165, 34504, 48661, 23479, 23712, 3125, 27457, 45832,
				57576, 30698, 50755, 24668, 21444, 31701, 1266, 39801, 55088,
				40631, 48935, 62795, 1907, 18846, 13079, 12777, 28387, 29511,
				65328, 14245, 45949, 9707, 17527, 36656, 64514, 64597, 24332,
				41975, 42885, 2098, 58374, 595, 25062, 18206, 50275, 27, 45671,
				22310, 29807, 43491, 34329, 14379, 46163, 57092, 27244, 37195,
				58541, 35907, 37931, 51759, 9396, 12290, 47203, 21769, 14392,
				36165, 57025, 48661, 34504, 23712, 23479, 27457, 3125, 57576,
				45832, 50755, 30698, 21444, 24668, 1266, 31701, 48935, 40631,
				55088, 39801, 13079, 18846, 1907, 62795, 65328, 29511, 28387,
				12777, 17527, 9707, 45949, 14245, 24332, 64597, 64514, 36656,
				58374, 2098, 42885, 41975, 50275, 18206, 25062, 595, 29807,
				22310, 45671, 27, 46163, 14379, 34329, 43491, 58541, 37195,
				27244, 57092, 9396, 51759, 37931, 35907, 14392, 21769, 47203,
				12290, 34504, 48661, 57025, 36165, 3125, 27457, 23479, 23712,
				30698, 50755, 45832, 57576, 31701, 1266, 24668, 21444, 40631,
				48935, 39801, 55088, 18846, 13079, 62795, 1907, 29511, 65328,
				12777, 28387, 9707, 17527, 14245, 45949, 64597, 24332, 36656,
				64514, 2098, 58374, 41975, 42885, 18206, 50275, 595, 25062,
				22310, 29807, 27, 45671, 14379, 46163, 43491, 34329, 37195,
				58541, 57092, 27244, 51759, 9396, 35907, 37931, 21769, 14392,
				12290, 47203, 48661, 34504, 36165, 57025, 27457, 3125, 23712,
				23479, 50755, 30698, 57576, 45832, 1266, 31701, 21444, 24668 };
		matrix H_cauchy;
		H_cauchy.rows = signature_block_size * extension;
		H_cauchy.cols = code_length;
		H_cauchy.data = correct_data_cauchy;

		gf correct_y[] = { 43950, 43950, 43950, 43950, 52805, 52805, 52805,
				52805, 26104, 26104, 26104, 26104, 57347, 57347, 57347, 57347,
				27792, 27792, 27792, 27792, 48480, 48480, 48480, 48480, 10248,
				10248, 10248, 10248, 17730, 17730, 17730, 17730, 34536, 34536,
				34536, 34536, 31390, 31390, 31390, 31390, 12762, 12762, 12762,
				12762, 51616, 51616, 51616, 51616, 2558, 2558, 2558, 2558,
				21743, 21743, 21743, 21743, 20055, 20055, 20055, 20055, 19083,
				19083, 19083, 19083 };
		gf correct_H[] = { 2239, 43780, 47610, 48212, 63124, 51015, 24638,
				43142, 62492, 53981, 15298, 55993, 17652, 30398, 36315, 6462,
				37536, 44029, 16316, 25527, 53507, 45656, 54633, 45997, 37873,
				40107, 33456, 44042, 8640, 37094, 14383, 39299, 15770, 12100,
				21857, 64246, 27614, 9031, 39224, 62697, 17915, 3811, 9651, 927,
				8535, 19960, 57774, 42483, 56927, 64776, 60412, 48532, 43369,
				50901, 44229, 35621, 31451, 7754, 3612, 39205, 14122, 33407,
				37498, 52566, 43780, 2239, 48212, 47610, 51015, 63124, 43142,
				24638, 53981, 62492, 55993, 15298, 30398, 17652, 6462, 36315,
				44029, 37536, 25527, 16316, 45656, 53507, 45997, 54633, 40107,
				37873, 44042, 33456, 37094, 8640, 39299, 14383, 12100, 15770,
				64246, 21857, 9031, 27614, 62697, 39224, 3811, 17915, 927, 9651,
				19960, 8535, 42483, 57774, 64776, 56927, 48532, 60412, 50901,
				43369, 35621, 44229, 7754, 31451, 39205, 3612, 33407, 14122,
				52566, 37498, 47610, 48212, 2239, 43780, 24638, 43142, 63124,
				51015, 15298, 55993, 62492, 53981, 36315, 6462, 17652, 30398,
				16316, 25527, 37536, 44029, 54633, 45997, 53507, 45656, 33456,
				44042, 37873, 40107, 14383, 39299, 8640, 37094, 21857, 64246,
				15770, 12100, 39224, 62697, 27614, 9031, 9651, 927, 17915, 3811,
				57774, 42483, 8535, 19960, 60412, 48532, 56927, 64776, 44229,
				35621, 43369, 50901, 3612, 39205, 31451, 7754, 37498, 52566,
				14122, 33407, 48212, 47610, 43780, 2239, 43142, 24638, 51015,
				63124, 55993, 15298, 53981, 62492, 6462, 36315, 30398, 17652,
				25527, 16316, 44029, 37536, 45997, 54633, 45656, 53507, 44042,
				33456, 40107, 37873, 39299, 14383, 37094, 8640, 64246, 21857,
				12100, 15770, 62697, 39224, 9031, 27614, 927, 9651, 3811, 17915,
				42483, 57774, 19960, 8535, 48532, 60412, 64776, 56927, 35621,
				44229, 50901, 43369, 39205, 3612, 7754, 31451, 52566, 37498,
				33407, 14122, 17805, 55428, 13661, 64688, 58508, 60848, 26292,
				24170, 34879, 16546, 28943, 610, 38095, 361, 26518, 35825,
				19939, 21852, 14729, 26729, 7747, 27478, 57557, 28257, 20594,
				18059, 58904, 29366, 34643, 29337, 30837, 14246, 1324, 31078,
				28131, 55591, 61700, 4539, 42387, 54831, 57253, 56998, 12117,
				6694, 35388, 32749, 14240, 13822, 34744, 21841, 16277, 42673,
				27774, 58436, 1884, 11797, 47674, 43129, 17564, 21420, 14604,
				8741, 4019, 14242, 55428, 17805, 64688, 13661, 60848, 58508,
				24170, 26292, 16546, 34879, 610, 28943, 361, 38095, 35825,
				26518, 21852, 19939, 26729, 14729, 27478, 7747, 28257, 57557,
				18059, 20594, 29366, 58904, 29337, 34643, 14246, 30837, 31078,
				1324, 55591, 28131, 4539, 61700, 54831, 42387, 56998, 57253,
				6694, 12117, 32749, 35388, 13822, 14240, 21841, 34744, 42673,
				16277, 58436, 27774, 11797, 1884, 43129, 47674, 21420, 17564,
				8741, 14604, 14242, 4019, 13661, 64688, 17805, 55428, 26292,
				24170, 58508, 60848, 28943, 610, 34879, 16546, 26518, 35825,
				38095, 361, 14729, 26729, 19939, 21852, 57557, 28257, 7747,
				27478, 58904, 29366, 20594, 18059, 30837, 14246, 34643, 29337,
				28131, 55591, 1324, 31078, 42387, 54831, 61700, 4539, 12117,
				6694, 57253, 56998, 14240, 13822, 35388, 32749, 16277, 42673,
				34744, 21841, 1884, 11797, 27774, 58436, 17564, 21420, 47674,
				43129, 4019, 14242, 14604, 8741, 64688, 13661, 55428, 17805,
				24170, 26292, 60848, 58508, 610, 28943, 16546, 34879, 35825,
				26518, 361, 38095, 26729, 14729, 21852, 19939, 28257, 57557,
				27478, 7747, 29366, 58904, 18059, 20594, 14246, 30837, 29337,
				34643, 55591, 28131, 31078, 1324, 54831, 42387, 4539, 61700,
				6694, 12117, 56998, 57253, 13822, 14240, 32749, 35388, 42673,
				16277, 21841, 34744, 11797, 1884, 58436, 27774, 21420, 17564,
				43129, 47674, 14242, 4019, 8741, 14604 };

		gf y[code_length] = { 0 };
		matrix H;
		H.rows = signature_block_size * extension;
		H.cols = code_length;
		gf data_H[signature_block_size * extension * code_length] = { 0 };
		H.data = data_H;

		build_trapdoor(&H_cauchy, correct_v, correct_u, y, &H);

		for (int i = 0; i < code_length; i++) {
			ck_assert_int_eq(y[i], correct_y[i]);
		}

		for (int i = 0; i < signature_block_size * extension; i++) {
			for (int j = 0; j < code_length; j++) {
				ck_assert_int_eq(H.data[i * H.cols + j],
						correct_H[i * H.cols + j]);
			}

		}

	}END_TEST

START_TEST(project_H_on_F_q_test)
	{

		gf correct_H[] = { 2239, 43780, 47610, 48212, 63124, 51015, 24638,
				43142, 62492, 53981, 15298, 55993, 17652, 30398, 36315, 6462,
				37536, 44029, 16316, 25527, 53507, 45656, 54633, 45997, 37873,
				40107, 33456, 44042, 8640, 37094, 14383, 39299, 15770, 12100,
				21857, 64246, 27614, 9031, 39224, 62697, 17915, 3811, 9651, 927,
				8535, 19960, 57774, 42483, 56927, 64776, 60412, 48532, 43369,
				50901, 44229, 35621, 31451, 7754, 3612, 39205, 14122, 33407,
				37498, 52566, 43780, 2239, 48212, 47610, 51015, 63124, 43142,
				24638, 53981, 62492, 55993, 15298, 30398, 17652, 6462, 36315,
				44029, 37536, 25527, 16316, 45656, 53507, 45997, 54633, 40107,
				37873, 44042, 33456, 37094, 8640, 39299, 14383, 12100, 15770,
				64246, 21857, 9031, 27614, 62697, 39224, 3811, 17915, 927, 9651,
				19960, 8535, 42483, 57774, 64776, 56927, 48532, 60412, 50901,
				43369, 35621, 44229, 7754, 31451, 39205, 3612, 33407, 14122,
				52566, 37498, 47610, 48212, 2239, 43780, 24638, 43142, 63124,
				51015, 15298, 55993, 62492, 53981, 36315, 6462, 17652, 30398,
				16316, 25527, 37536, 44029, 54633, 45997, 53507, 45656, 33456,
				44042, 37873, 40107, 14383, 39299, 8640, 37094, 21857, 64246,
				15770, 12100, 39224, 62697, 27614, 9031, 9651, 927, 17915, 3811,
				57774, 42483, 8535, 19960, 60412, 48532, 56927, 64776, 44229,
				35621, 43369, 50901, 3612, 39205, 31451, 7754, 37498, 52566,
				14122, 33407, 48212, 47610, 43780, 2239, 43142, 24638, 51015,
				63124, 55993, 15298, 53981, 62492, 6462, 36315, 30398, 17652,
				25527, 16316, 44029, 37536, 45997, 54633, 45656, 53507, 44042,
				33456, 40107, 37873, 39299, 14383, 37094, 8640, 64246, 21857,
				12100, 15770, 62697, 39224, 9031, 27614, 927, 9651, 3811, 17915,
				42483, 57774, 19960, 8535, 48532, 60412, 64776, 56927, 35621,
				44229, 50901, 43369, 39205, 3612, 7754, 31451, 52566, 37498,
				33407, 14122, 17805, 55428, 13661, 64688, 58508, 60848, 26292,
				24170, 34879, 16546, 28943, 610, 38095, 361, 26518, 35825,
				19939, 21852, 14729, 26729, 7747, 27478, 57557, 28257, 20594,
				18059, 58904, 29366, 34643, 29337, 30837, 14246, 1324, 31078,
				28131, 55591, 61700, 4539, 42387, 54831, 57253, 56998, 12117,
				6694, 35388, 32749, 14240, 13822, 34744, 21841, 16277, 42673,
				27774, 58436, 1884, 11797, 47674, 43129, 17564, 21420, 14604,
				8741, 4019, 14242, 55428, 17805, 64688, 13661, 60848, 58508,
				24170, 26292, 16546, 34879, 610, 28943, 361, 38095, 35825,
				26518, 21852, 19939, 26729, 14729, 27478, 7747, 28257, 57557,
				18059, 20594, 29366, 58904, 29337, 34643, 14246, 30837, 31078,
				1324, 55591, 28131, 4539, 61700, 54831, 42387, 56998, 57253,
				6694, 12117, 32749, 35388, 13822, 14240, 21841, 34744, 42673,
				16277, 58436, 27774, 11797, 1884, 43129, 47674, 21420, 17564,
				8741, 14604, 14242, 4019, 13661, 64688, 17805, 55428, 26292,
				24170, 58508, 60848, 28943, 610, 34879, 16546, 26518, 35825,
				38095, 361, 14729, 26729, 19939, 21852, 57557, 28257, 7747,
				27478, 58904, 29366, 20594, 18059, 30837, 14246, 34643, 29337,
				28131, 55591, 1324, 31078, 42387, 54831, 61700, 4539, 12117,
				6694, 57253, 56998, 14240, 13822, 35388, 32749, 16277, 42673,
				34744, 21841, 1884, 11797, 27774, 58436, 17564, 21420, 47674,
				43129, 4019, 14242, 14604, 8741, 64688, 13661, 55428, 17805,
				24170, 26292, 60848, 58508, 610, 28943, 16546, 34879, 35825,
				26518, 361, 38095, 26729, 14729, 21852, 19939, 28257, 57557,
				27478, 7747, 29366, 58904, 18059, 20594, 14246, 30837, 29337,
				34643, 55591, 28131, 31078, 1324, 54831, 42387, 4539, 61700,
				6694, 12117, 56998, 57253, 13822, 14240, 32749, 35388, 42673,
				16277, 21841, 34744, 11797, 1884, 58436, 27774, 21420, 17564,
				43129, 47674, 14242, 4019, 8741, 14604 };

		matrix H;
		H.rows = signature_block_size * extension;
		H.cols = code_length;
		H.data = correct_H;
		gf h_base_correct[] = { 90, 5, 189, 105, 221, 70, 228, 211, 254, 125,
				74, 142, 181, 213, 168, 53, 74, 6, 195, 57, 241, 238, 92, 26,
				230, 206, 13, 82, 221, 229, 75, 232, 178, 160, 254, 85, 195,
				247, 159, 245, 67, 160, 93, 249, 8, 109, 101, 129, 219, 10, 193,
				18, 11, 111, 223, 8, 94, 144, 161, 176, 56, 128, 226, 151, 5,
				90, 105, 189, 70, 221, 211, 228, 125, 254, 142, 74, 213, 181,
				53, 168, 6, 74, 57, 195, 238, 241, 26, 92, 206, 230, 82, 13,
				229, 221, 232, 75, 160, 178, 85, 254, 247, 195, 245, 159, 160,
				67, 249, 93, 109, 8, 129, 101, 10, 219, 18, 193, 111, 11, 8,
				223, 144, 94, 176, 161, 128, 56, 151, 226, 189, 105, 90, 5, 228,
				211, 221, 70, 74, 142, 254, 125, 168, 53, 181, 213, 195, 57, 74,
				6, 92, 26, 241, 238, 13, 82, 230, 206, 75, 232, 221, 229, 254,
				85, 178, 160, 159, 245, 195, 247, 93, 249, 67, 160, 101, 129, 8,
				109, 193, 18, 219, 10, 223, 8, 11, 111, 161, 176, 94, 144, 226,
				151, 56, 128, 105, 189, 5, 90, 211, 228, 70, 221, 142, 74, 125,
				254, 53, 168, 213, 181, 57, 195, 6, 74, 26, 92, 238, 241, 82,
				13, 206, 230, 232, 75, 229, 221, 85, 254, 160, 178, 245, 159,
				247, 195, 249, 93, 160, 67, 129, 101, 109, 8, 18, 193, 10, 219,
				8, 223, 111, 11, 176, 161, 144, 94, 151, 226, 128, 56, 185, 210,
				26, 131, 73, 29, 190, 252, 2, 156, 247, 7, 61, 42, 235, 168, 64,
				123, 236, 154, 155, 57, 105, 48, 95, 157, 68, 166, 164, 5, 213,
				192, 36, 13, 230, 118, 84, 233, 95, 12, 38, 216, 135, 63, 218,
				86, 194, 65, 129, 114, 98, 211, 198, 199, 5, 12, 31, 210, 97,
				211, 31, 214, 13, 194, 210, 185, 131, 26, 29, 73, 252, 190, 156,
				2, 7, 247, 42, 61, 168, 235, 123, 64, 154, 236, 57, 155, 48,
				105, 157, 95, 166, 68, 5, 164, 192, 213, 13, 36, 118, 230, 233,
				84, 12, 95, 216, 38, 63, 135, 86, 218, 65, 194, 114, 129, 211,
				98, 199, 198, 12, 5, 210, 31, 211, 97, 214, 31, 194, 13, 26,
				131, 185, 210, 190, 252, 73, 29, 247, 7, 2, 156, 235, 168, 61,
				42, 236, 154, 64, 123, 105, 48, 155, 57, 68, 166, 95, 157, 213,
				192, 164, 5, 230, 118, 36, 13, 95, 12, 84, 233, 135, 63, 38,
				216, 194, 65, 218, 86, 98, 211, 129, 114, 5, 12, 198, 199, 97,
				211, 31, 210, 13, 194, 31, 214, 131, 26, 210, 185, 252, 190, 29,
				73, 7, 247, 156, 2, 168, 235, 42, 61, 154, 236, 123, 64, 48,
				105, 57, 155, 166, 68, 157, 95, 192, 213, 5, 164, 118, 230, 13,
				36, 12, 95, 233, 84, 63, 135, 216, 38, 65, 194, 86, 218, 211,
				98, 114, 129, 12, 5, 199, 198, 211, 97, 210, 31, 194, 13, 214,
				31, 55, 87, 71, 224, 49, 62, 79, 247, 97, 160, 86, 89, 46, 198,
				212, 119, 245, 162, 207, 253, 59, 99, 242, 98, 58, 114, 243,
				137, 8, 59, 163, 32, 67, 105, 62, 85, 18, 79, 172, 130, 219, 39,
				135, 227, 168, 100, 214, 32, 119, 109, 246, 139, 177, 121, 23,
				14, 166, 172, 214, 239, 209, 109, 59, 103, 87, 55, 224, 71, 62,
				49, 247, 79, 160, 97, 89, 86, 198, 46, 119, 212, 162, 245, 253,
				207, 99, 59, 98, 242, 114, 58, 137, 243, 59, 8, 32, 163, 105,
				67, 85, 62, 79, 18, 130, 172, 39, 219, 227, 135, 100, 168, 32,
				214, 109, 119, 139, 246, 121, 177, 14, 23, 172, 166, 239, 214,
				109, 209, 103, 59, 71, 224, 55, 87, 79, 247, 49, 62, 86, 89, 97,
				160, 212, 119, 46, 198, 207, 253, 245, 162, 242, 98, 59, 99,
				243, 137, 58, 114, 163, 32, 8, 59, 62, 85, 67, 105, 172, 130,
				18, 79, 135, 227, 219, 39, 214, 32, 168, 100, 246, 139, 119,
				109, 23, 14, 177, 121, 214, 239, 166, 172, 59, 103, 209, 109,
				224, 71, 87, 55, 247, 79, 62, 49, 89, 86, 160, 97, 119, 212,
				198, 46, 253, 207, 162, 245, 98, 242, 99, 59, 137, 243, 114, 58,
				32, 163, 59, 8, 85, 62, 105, 67, 130, 172, 79, 18, 227, 135, 39,
				219, 32, 214, 100, 168, 139, 246, 109, 119, 14, 23, 121, 177,
				239, 214, 172, 166, 103, 59, 109, 209, 200, 146, 112, 2, 150,
				179, 135, 194, 25, 158, 145, 241, 139, 179, 94, 215, 35, 71,
				142, 216, 191, 240, 49, 224, 17, 156, 133, 76, 58, 97, 200, 54,
				87, 126, 64, 186, 92, 61, 98, 222, 97, 130, 60, 97, 170, 182,
				50, 186, 155, 81, 230, 9, 16, 12, 242, 166, 158, 6, 127, 138,
				122, 238, 232, 51, 146, 200, 2, 112, 179, 150, 194, 135, 158,
				25, 241, 145, 179, 139, 215, 94, 71, 35, 216, 142, 240, 191,
				224, 49, 156, 17, 76, 133, 97, 58, 54, 200, 126, 87, 186, 64,
				61, 92, 222, 98, 130, 97, 97, 60, 182, 170, 186, 50, 81, 155, 9,
				230, 12, 16, 166, 242, 6, 158, 138, 127, 238, 122, 51, 232, 112,
				2, 200, 146, 135, 194, 150, 179, 145, 241, 25, 158, 94, 215,
				139, 179, 142, 216, 35, 71, 49, 224, 191, 240, 133, 76, 17, 156,
				200, 54, 58, 97, 64, 186, 87, 126, 98, 222, 92, 61, 60, 97, 97,
				130, 50, 186, 170, 182, 230, 9, 155, 81, 242, 166, 16, 12, 127,
				138, 158, 6, 232, 51, 122, 238, 2, 112, 146, 200, 194, 135, 179,
				150, 241, 145, 158, 25, 215, 94, 179, 139, 216, 142, 71, 35,
				224, 49, 240, 191, 76, 133, 156, 17, 54, 200, 97, 58, 186, 64,
				126, 87, 222, 98, 61, 92, 97, 60, 130, 97, 186, 50, 182, 170, 9,
				230, 81, 155, 166, 242, 12, 16, 138, 127, 6, 158, 51, 232, 238,
				122 };

		matrix Hbase;
		Hbase.rows = (signature_block_size * extension) * extension;
		Hbase.cols = code_length;
		gf data_Hbase[signature_block_size * extension * code_length * extension] =
				{ 0 };
		Hbase.data = data_Hbase;
		project_H_on_F_q(&H, &Hbase);

		for (int i = 0; i < (signature_block_size * extension) * extension;
				i++) {
			for (int j = 0; j < code_length; j++) {
				ck_assert_int_eq(Hbase.data[i * Hbase.cols + j],
						h_base_correct[i * Hbase.cols + j]);
			}

		}

	}END_TEST

START_TEST(generate_public_key_test)
	{

		gf h_base_correct[] = { 75, 48, 84, 216, 151, 12, 181, 27, 42, 202, 152,
				248, 118, 48, 112, 220, 42, 151, 251, 211, 7, 164, 159, 8, 96,
				26, 193, 171, 18, 65, 136, 162, 1, 101, 14, 95, 233, 63, 84,
				187, 81, 69, 156, 63, 101, 18, 129, 154, 25, 161, 31, 238, 248,
				88, 53, 101, 192, 243, 13, 109, 246, 168, 189, 144, 48, 75, 216,
				84, 12, 151, 27, 181, 202, 42, 248, 152, 48, 118, 220, 112, 151,
				42, 211, 251, 164, 7, 8, 159, 26, 96, 171, 193, 65, 18, 162,
				136, 101, 1, 95, 14, 63, 233, 187, 84, 69, 81, 63, 156, 18, 101,
				154, 129, 161, 25, 238, 31, 88, 248, 101, 53, 243, 192, 109, 13,
				168, 246, 144, 189, 84, 216, 75, 48, 181, 27, 151, 12, 152, 248,
				42, 202, 112, 220, 118, 48, 251, 211, 42, 151, 159, 8, 7, 164,
				193, 171, 96, 26, 136, 162, 18, 65, 14, 95, 1, 101, 84, 187,
				233, 63, 156, 63, 81, 69, 129, 154, 101, 18, 31, 238, 25, 161,
				53, 101, 248, 88, 13, 109, 192, 243, 189, 144, 246, 168, 216,
				84, 48, 75, 27, 181, 12, 151, 248, 152, 202, 42, 220, 112, 48,
				118, 211, 251, 151, 42, 8, 159, 164, 7, 171, 193, 26, 96, 162,
				136, 65, 18, 95, 14, 101, 1, 187, 84, 63, 233, 63, 156, 69, 81,
				154, 129, 18, 101, 238, 31, 161, 25, 101, 53, 88, 248, 109, 13,
				243, 192, 144, 189, 168, 246, 160, 73, 219, 151, 50, 1, 96, 220,
				39, 47, 254, 135, 117, 38, 202, 222, 46, 36, 246, 19, 65, 73,
				123, 65, 152, 103, 105, 70, 174, 52, 129, 17, 9, 102, 25, 181,
				212, 200, 90, 252, 159, 131, 121, 42, 72, 0, 186, 94, 69, 23,
				252, 166, 102, 184, 167, 45, 181, 64, 157, 125, 87, 136, 6, 16,
				73, 160, 151, 219, 1, 50, 220, 96, 47, 39, 135, 254, 38, 117,
				222, 202, 36, 46, 19, 246, 73, 65, 65, 123, 103, 152, 70, 105,
				52, 174, 17, 129, 102, 9, 181, 25, 200, 212, 252, 90, 131, 159,
				42, 121, 0, 72, 94, 186, 23, 69, 166, 252, 184, 102, 45, 167,
				64, 181, 125, 157, 136, 87, 16, 6, 219, 151, 160, 73, 96, 220,
				50, 1, 254, 135, 39, 47, 202, 222, 117, 38, 246, 19, 46, 36,
				123, 65, 65, 73, 105, 70, 152, 103, 129, 17, 174, 52, 25, 181,
				9, 102, 90, 252, 212, 200, 121, 42, 159, 131, 186, 94, 72, 0,
				252, 166, 69, 23, 167, 45, 102, 184, 157, 125, 181, 64, 6, 16,
				87, 136, 151, 219, 73, 160, 220, 96, 1, 50, 135, 254, 47, 39,
				222, 202, 38, 117, 19, 246, 36, 46, 65, 123, 73, 65, 70, 105,
				103, 152, 17, 129, 52, 174, 181, 25, 102, 9, 252, 90, 200, 212,
				42, 121, 131, 159, 94, 186, 0, 72, 166, 252, 23, 69, 45, 167,
				184, 102, 125, 157, 64, 181, 16, 6, 136, 87, 61, 109, 101, 174,
				222, 9, 132, 182, 167, 226, 157, 102, 149, 102, 39, 220, 85, 81,
				194, 251, 121, 7, 210, 101, 145, 0, 41, 194, 57, 217, 94, 40,
				128, 173, 110, 59, 108, 199, 116, 122, 179, 207, 104, 156, 175,
				56, 62, 215, 113, 65, 239, 59, 111, 157, 48, 101, 51, 198, 88,
				191, 1, 121, 159, 156, 109, 61, 174, 101, 9, 222, 182, 132, 226,
				167, 102, 157, 102, 149, 220, 39, 81, 85, 251, 194, 7, 121, 101,
				210, 0, 145, 194, 41, 217, 57, 40, 94, 173, 128, 59, 110, 199,
				108, 122, 116, 207, 179, 156, 104, 56, 175, 215, 62, 65, 113,
				59, 239, 157, 111, 101, 48, 198, 51, 191, 88, 121, 1, 156, 159,
				101, 174, 61, 109, 132, 182, 222, 9, 157, 102, 167, 226, 39,
				220, 149, 102, 194, 251, 85, 81, 210, 101, 121, 7, 41, 194, 145,
				0, 94, 40, 57, 217, 110, 59, 128, 173, 116, 122, 108, 199, 104,
				156, 179, 207, 62, 215, 175, 56, 239, 59, 113, 65, 48, 101, 111,
				157, 88, 191, 51, 198, 159, 156, 1, 121, 174, 101, 109, 61, 182,
				132, 9, 222, 102, 157, 226, 167, 220, 39, 102, 149, 251, 194,
				81, 85, 101, 210, 7, 121, 194, 41, 0, 145, 40, 94, 217, 57, 59,
				110, 173, 128, 122, 116, 199, 108, 156, 104, 207, 179, 215, 62,
				56, 175, 59, 239, 65, 113, 101, 48, 157, 111, 191, 88, 198, 51,
				156, 159, 121, 1, 106, 240, 222, 187, 221, 89, 48, 37, 114, 205,
				37, 10, 210, 173, 165, 245, 88, 200, 152, 3, 65, 225, 160, 164,
				23, 117, 141, 236, 113, 183, 13, 84, 216, 53, 189, 150, 43, 38,
				78, 174, 61, 22, 115, 175, 9, 5, 200, 119, 65, 28, 51, 121, 8,
				53, 119, 218, 146, 85, 44, 120, 51, 210, 216, 89, 240, 106, 187,
				222, 89, 221, 37, 48, 205, 114, 10, 37, 173, 210, 245, 165, 200,
				88, 3, 152, 225, 65, 164, 160, 117, 23, 236, 141, 183, 113, 84,
				13, 53, 216, 150, 189, 38, 43, 174, 78, 22, 61, 175, 115, 5, 9,
				119, 200, 28, 65, 121, 51, 53, 8, 218, 119, 85, 146, 120, 44,
				210, 51, 89, 216, 222, 187, 106, 240, 48, 37, 221, 89, 37, 10,
				114, 205, 165, 245, 210, 173, 152, 3, 88, 200, 160, 164, 65,
				225, 141, 236, 23, 117, 13, 84, 113, 183, 189, 150, 216, 53, 78,
				174, 43, 38, 115, 175, 61, 22, 200, 119, 9, 5, 51, 121, 65, 28,
				119, 218, 8, 53, 44, 120, 146, 85, 216, 89, 51, 210, 187, 222,
				240, 106, 37, 48, 89, 221, 10, 37, 205, 114, 245, 165, 173, 210,
				3, 152, 200, 88, 164, 160, 225, 65, 236, 141, 117, 23, 84, 13,
				183, 113, 150, 189, 53, 216, 174, 78, 38, 43, 175, 115, 22, 61,
				119, 200, 5, 9, 121, 51, 28, 65, 218, 119, 53, 8, 120, 44, 85,
				146, 89, 216, 210, 51 };

		matrix Hbase;
		Hbase.rows = (signature_block_size * extension) * extension;
		Hbase.cols = code_length;
		Hbase.data = h_base_correct;

		gf correct_G[] = { 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 106, 83, 78, 96, 155, 244, 43, 244,
				49, 70, 177, 128, 252, 65, 12, 202, 0, 1, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 83, 106,
				96, 78, 244, 155, 244, 43, 70, 49, 128, 177, 65, 252, 202, 12,
				0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 78, 96, 106, 83, 43, 244, 155, 244, 177, 128,
				49, 70, 12, 202, 252, 65, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 96, 78, 83, 106, 244,
				43, 244, 155, 128, 177, 70, 49, 202, 12, 65, 252, 0, 0, 0, 0, 1,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 243, 61, 39, 251, 105, 47, 232, 83, 188, 178, 3, 166, 235,
				90, 220, 122, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 61, 243, 251, 39, 47, 105, 83,
				232, 178, 188, 166, 3, 90, 235, 122, 220, 0, 0, 0, 0, 0, 0, 1,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39,
				251, 243, 61, 232, 83, 105, 47, 3, 166, 188, 178, 220, 122, 235,
				90, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 251, 39, 61, 243, 83, 232, 47, 105, 166, 3,
				178, 188, 122, 220, 90, 235, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 137, 71, 199, 84,
				67, 16, 44, 43, 135, 37, 235, 194, 46, 38, 177, 44, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 71, 137, 84, 199, 16, 67, 43, 44, 37, 135, 194, 235, 38,
				46, 44, 177, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 199, 84, 137, 71, 44, 43, 67, 16,
				235, 194, 135, 37, 177, 44, 46, 38, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 199,
				71, 137, 43, 44, 16, 67, 194, 235, 37, 135, 44, 177, 38, 46, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 65, 60, 47, 108, 244, 216, 127, 152, 136, 77, 28,
				156, 152, 130, 113, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 60, 65, 108, 47, 216,
				244, 152, 127, 77, 136, 156, 28, 130, 152, 167, 113, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 47, 108, 65, 60, 127, 152, 244, 216, 28, 156, 136, 77,
				113, 167, 152, 130, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 108, 47, 60, 65, 152, 127,
				216, 244, 156, 28, 77, 136, 167, 113, 130, 152, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 173, 7, 2, 167, 113, 97, 197, 238, 141, 129, 16, 192, 79,
				189, 209, 40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, 173, 167, 2, 97, 113, 238, 197,
				129, 141, 192, 16, 189, 79, 40, 209, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 167,
				173, 7, 197, 238, 113, 97, 16, 192, 141, 129, 209, 40, 79, 189,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 167, 2, 7, 173, 238, 197, 97, 113, 192, 16,
				129, 141, 40, 209, 189, 79, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 75, 27, 71, 198,
				56, 133, 26, 211, 0, 188, 120, 92, 150, 98, 80, 133, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 27, 75, 198, 71, 133, 56, 211, 26, 188, 0, 92, 120, 98,
				150, 133, 80, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 71, 198, 75, 27, 26, 211, 56, 133,
				120, 92, 0, 188, 80, 133, 150, 98, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 198, 71, 27,
				75, 211, 26, 133, 56, 92, 120, 188, 0, 133, 80, 98, 150, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 144, 252, 212, 9, 98, 73, 98, 206, 229, 228, 185,
				115, 169, 72, 238, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 252, 144, 9, 212, 73, 98,
				206, 98, 228, 229, 115, 185, 72, 169, 83, 238, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				212, 9, 144, 252, 98, 206, 98, 73, 185, 115, 229, 228, 238, 83,
				169, 72, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 212, 252, 144, 206, 98, 73, 98,
				115, 185, 228, 229, 83, 238, 72, 169, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 88, 113,
				203, 7, 73, 23, 192, 167, 103, 53, 7, 186, 239, 181, 21, 209, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 113, 88, 7, 203, 23, 73, 167, 192, 53, 103, 186,
				7, 181, 239, 209, 21, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 203, 7, 88, 113, 192,
				167, 73, 23, 7, 186, 103, 53, 21, 209, 239, 181, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 7, 203, 113, 88, 167, 192, 23, 73, 186, 7, 53, 103, 209, 21,
				181, 239, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 159, 16, 235, 93, 103, 138, 49, 193,
				33, 2, 2, 48, 245, 234, 154, 232, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 159, 93,
				235, 138, 103, 193, 49, 2, 33, 48, 2, 234, 245, 232, 154, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 235, 93, 159, 16, 49, 193, 103, 138, 2, 48, 33, 2,
				154, 232, 245, 234, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 93, 235, 16, 159, 193, 49,
				138, 103, 48, 2, 2, 33, 232, 154, 234, 245, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 183,
				212, 209, 24, 133, 167, 206, 233, 240, 192, 42, 179, 239, 56,
				158, 203, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 212, 183, 24, 209, 167, 133, 233,
				206, 192, 240, 179, 42, 56, 239, 203, 158, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 209,
				24, 183, 212, 206, 233, 133, 167, 42, 179, 240, 192, 158, 203,
				239, 56, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				1, 0, 0, 0, 0, 0, 0, 0, 0, 24, 209, 212, 183, 233, 206, 167,
				133, 179, 42, 192, 240, 203, 158, 56, 239, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 20,
				248, 17, 221, 73, 47, 86, 114, 40, 62, 235, 60, 116, 119, 188,
				255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				1, 0, 0, 0, 0, 0, 0, 248, 20, 221, 17, 47, 73, 114, 86, 62, 40,
				60, 235, 119, 116, 255, 188, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 17, 221, 20, 248,
				86, 114, 73, 47, 235, 60, 40, 62, 188, 255, 116, 119, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
				0, 0, 0, 221, 17, 248, 20, 114, 86, 47, 73, 60, 235, 62, 40,
				255, 188, 119, 116, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 16, 159, 226, 216, 90, 156,
				43, 52, 133, 110, 14, 246, 52, 170, 17, 147, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
				159, 16, 216, 226, 156, 90, 52, 43, 110, 133, 246, 14, 170, 52,
				147, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 1, 0, 226, 216, 16, 159, 43, 52, 90, 156,
				14, 246, 133, 110, 17, 147, 52, 170, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 216, 226,
				159, 16, 52, 43, 156, 90, 246, 14, 110, 133, 147, 17, 170, 52 };

		matrix G;
		G.cols = code_length;
		G.rows = code_length - ((signature_block_size * extension) * extension);
		gf data_G[code_length
				* (code_length
						- ((signature_block_size * extension) * extension))] = {
				0 };
		G.data = data_G;
		generate_public_key(&Hbase, &G);



		for (int i = 0; i < G.rows; i++) {
			for (int j = 0; j < G.cols; j++) {
				ck_assert_int_eq(G.data[i * G.cols + j],
						correct_G[i * G.cols + j]);
			}

		}

	}END_TEST
Suite * key_gen_suite(void) {
	Suite *s;
	TCase *tc_core;

	s = suite_create("key_gen_suite");

	/* Core test case */
	tc_core = tcase_create("key_gen_suite");
	tcase_set_timeout(tc_core, 10000000000);

	//tcase_add_test(tc_core, build_signature_h_test);
	tcase_add_test(tc_core, build_support_test);
	tcase_add_test(tc_core, build_cauchy_matrix_test);
	tcase_add_test(tc_core, build_trapdoor_test);
	tcase_add_test(tc_core, project_H_on_F_q_test);
	tcase_add_test(tc_core, generate_public_key_test);
	suite_add_tcase(s, tc_core);

	return s;
}
#endif
#endif

/*
 * check_key_generation.c
 *
 *  Created on: Jun 11, 2018
 *      Author: vader
 */

#include "check_matrix.h"

#if defined(TEST)
#if defined(DAGS_3) || defined(DAGS_5) || defined(DAGS_TOY)

START_TEST(make_matrix_test)
	{
		int i, j;
		matrix *G;
		G = make_matrix(2, 2);

		ck_assert_int_eq(G->rows, 2);
		ck_assert_int_eq(G->cols, 2);
		for (i = 0; i < G->rows; i++) {
			for (j = 0; j < G->cols; j++)
				ck_assert_int_eq(G->data[i * G->cols + j], 0);
		}

		free_matrix(G);

		G = make_matrix(50, 50);

		ck_assert_int_eq(G->rows, 50);
		ck_assert_int_eq(G->cols, 50);
		for (i = 0; i < G->rows; i++) {
			for (j = 0; j < G->cols; j++)
				ck_assert_int_eq(G->data[i * G->cols + j], 0);
		}
		free_matrix(G);

	}END_TEST

START_TEST(augment_matrix_test)
	{
		matrix *G, *Y;
		G = make_matrix(2, 2);
		Y = make_matrix(2, 1);
		G->data[0] = 1;
		G->data[1] = 1;
		G->data[2] = 5;
		G->data[3] = 5;

		Y->data[0] = 3;
		Y->data[1] = 2;

		matrix *augmented = augment(G, Y);

		ck_assert_int_eq(G->data[0], augmented->data[0]);
		ck_assert_int_eq(G->data[1], augmented->data[1]);
		ck_assert_int_eq(Y->data[0], augmented->data[2]);
		ck_assert_int_eq(G->data[2], augmented->data[3]);
		ck_assert_int_eq(G->data[3], augmented->data[4]);
		ck_assert_int_eq(Y->data[1], augmented->data[5]);

		free_matrix(G);
		free_matrix(Y);
		free_matrix(augmented);

	}END_TEST

START_TEST(echelon_form_test)
	{
		matrix *G;
		G = make_matrix(3, 3);
		G->data[0] = 1;
		G->data[1] = 2;
		G->data[2] = 4;
		G->data[3] = 0;
		G->data[4] = 15;
		G->data[5] = 59;
		ck_assert_int_eq(G->data[0], 1);
		ck_assert_int_eq(G->data[1], 2);

		ck_assert_int_ne(G->data[2], 0);

		echelon_form(G);

		ck_assert_int_eq(G->data[0], 1);
		ck_assert_int_eq(G->data[1], 0);
		ck_assert_int_eq(G->data[2], 155);
		ck_assert_int_eq(G->data[3], 0);
		ck_assert_int_eq(G->data[4], 1);
		ck_assert_int_eq(G->data[5], 193);
		ck_assert_int_eq(G->data[6], 0);
		ck_assert_int_eq(G->data[7], 0);
		ck_assert_int_eq(G->data[8], 0);
		free_matrix(G);

		matrix L;
		L.rows = 5;
		L.cols = 10;
		gf data[] = { 198, 146, 49, 191, 52, 140, 229, 211, 32, 147, 145, 241,
				149, 22, 151, 82, 71, 218, 123, 187, 121, 33, 238, 179, 207, 37,
				11, 93, 226, 235, 126, 30, 4, 2, 1, 63, 13, 228, 59, 152, 137,
				72, 239, 69, 114, 208, 78, 176, 248, 15 };
		L.data = data;
		echelon_form(&L);
		gf data_r[] = { 1, 0, 0, 0, 0, 89, 147, 218, 83, 176, 0, 1, 0, 0, 0,
				247, 184, 8, 22, 140, 0, 0, 1, 0, 0, 18, 140, 154, 148, 75, 0,
				0, 0, 1, 0, 107, 172, 235, 229, 41, 0, 0, 0, 0, 1, 101, 211, 18,
				248, 241 };
		for (int i = 0; i < (5 * 10); i++) {
			ck_assert_int_eq(L.data[i], data_r[i]);
		}

		matrix jj;
		jj.rows = 5;
		jj.cols = 12;
		gf data_jj[] = { 186, 103, 233, 203, 7, 156, 125, 30, 207, 32, 246, 220,
				231, 110, 130, 208, 77, 25, 144, 118, 166, 69, 79, 235, 173,
				191, 77, 7, 218, 187, 215, 49, 96, 3, 77, 130, 214, 113, 81,
				149, 23, 104, 143, 146, 173, 138, 174, 113, 62, 136, 127, 157,
				175, 147, 211, 200, 106, 48, 167, 114 };
		jj.data = data_jj;
		echelon_form(&jj);
		gf data_r2[] = { 1, 0, 0, 0, 0, 213, 84, 59, 46, 207, 120, 24, 0, 1, 0,
				0, 0, 119, 93, 252, 118, 85, 242, 151, 0, 0, 1, 0, 0, 167, 55,
				113, 141, 104, 9, 43, 0, 0, 0, 1, 0, 108, 134, 115, 160, 102,
				138, 89, 0, 0, 0, 0, 1, 196, 165, 243, 215, 229, 67, 154 };
		for (int i = 0; i < jj.rows * jj.cols; i++) {
			ck_assert_int_eq(jj.data[i], data_r2[i]);
		}

		matrix jj2;
		jj2.rows = 5;
		jj2.cols = 15;
		gf data_jj2[] = { 25, 248, 237, 93, 35, 215, 202, 245, 71, 127, 143,
				198, 41, 171, 206, 132, 49, 243, 8, 208, 83, 108, 53, 68, 67,
				223, 174, 99, 64, 245, 238, 198, 1, 46, 56, 87, 37, 194, 11,
				188, 175, 48, 138, 93, 15, 175, 214, 81, 121, 193, 252, 94, 143,
				76, 57, 202, 70, 3, 239, 26, 68, 95, 134, 176, 37, 108, 57, 55,
				71, 191, 232, 10, 96, 35, 151 };
		jj2.data = data_jj2;
		echelon_form(&jj2);
		gf data_r3[] = { 1, 0, 0, 0, 0, 229, 1, 53, 221, 183, 36, 61, 255, 50,
				160, 0, 1, 0, 0, 0, 178, 102, 224, 147, 112, 47, 184, 217, 19,
				185, 0, 0, 1, 0, 0, 101, 209, 96, 221, 84, 152, 205, 183, 112,
				239, 0, 0, 0, 1, 0, 105, 221, 12, 188, 75, 2, 8, 144, 173, 53,
				0, 0, 0, 0, 1, 151, 255, 14, 179, 253, 37, 88, 23, 233, 86 };
		for (int i = 0; i < jj2.rows * jj2.cols; i++) {
			ck_assert_int_eq(jj2.data[i], data_r3[i]);
		}

		matrix jj3;
		jj3.rows = 11;
		jj3.cols = 25;
		gf data_jj3[] = { 20, 200, 95, 135, 20, 42, 202, 139, 166, 144, 91, 57,
				186, 11, 137, 167, 220, 23, 177, 194, 166, 208, 234, 130, 9, 76,
				152, 147, 121, 103, 90, 93, 165, 206, 160, 121, 102, 142, 240,
				206, 129, 105, 214, 171, 246, 8, 118, 72, 96, 96, 231, 122, 196,
				255, 230, 113, 32, 91, 245, 220, 38, 72, 20, 163, 185, 52, 89,
				71, 250, 105, 118, 90, 222, 228, 58, 129, 146, 16, 172, 129,
				180, 96, 127, 67, 194, 22, 23, 71, 28, 71, 52, 222, 65, 235,
				218, 146, 119, 150, 83, 231, 234, 187, 123, 125, 211, 179, 216,
				218, 227, 51, 35, 125, 168, 47, 246, 139, 102, 188, 115, 238,
				238, 105, 145, 91, 70, 216, 85, 93, 206, 54, 235, 195, 201, 1,
				25, 45, 44, 32, 127, 88, 59, 141, 238, 133, 112, 120, 245, 28,
				4, 74, 34, 200, 27, 223, 61, 60, 186, 61, 30, 46, 96, 176, 102,
				191, 111, 4, 210, 79, 221, 88, 55, 184, 243, 217, 174, 166, 32,
				185, 218, 235, 179, 180, 102, 203, 85, 87, 232, 72, 33, 204,
				115, 3, 11, 73, 236, 73, 194, 195, 138, 50, 84, 42, 54, 192,
				111, 204, 85, 170, 135, 56, 178, 34, 136, 28, 230, 178, 223,
				247, 48, 68, 102, 68, 23, 71, 145, 21, 212, 70, 139, 205, 32,
				124, 54, 211, 80, 161, 198, 122, 116, 136, 26, 5, 197, 115, 91,
				215, 194, 84, 53, 67, 179, 234, 123, 41, 240, 30, 216, 105, 96,
				214, 104, 236, 97, 198, 0, 20, 244, 85, 51, 29, 93, 41, 33, 93,
				58 };
		jj3.data = data_jj3;
		echelon_form(&jj3);
		gf data_r4[] = { 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 62, 50, 246, 12, 17,
				30, 57, 246, 145, 105, 191, 82, 185, 24, 0, 1, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 191, 38, 62, 223, 160, 182, 244, 15, 215, 145, 4, 13,
				169, 40, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 71, 140, 76, 60, 117,
				44, 93, 247, 235, 147, 235, 216, 26, 164, 0, 0, 0, 1, 0, 0, 0,
				0, 0, 0, 0, 117, 32, 38, 147, 216, 25, 166, 41, 188, 156, 42,
				138, 169, 208, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 90, 132, 96,
				195, 171, 236, 4, 144, 120, 229, 239, 236, 7, 236, 0, 0, 0, 0,
				0, 1, 0, 0, 0, 0, 0, 118, 159, 84, 69, 24, 88, 251, 61, 85, 43,
				215, 138, 16, 151, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 38, 181,
				137, 184, 213, 68, 50, 32, 70, 194, 36, 50, 38, 68, 0, 0, 0, 0,
				0, 0, 0, 1, 0, 0, 0, 36, 239, 135, 58, 107, 174, 7, 155, 218, 1,
				160, 40, 194, 8, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 85, 75, 90,
				13, 200, 87, 3, 90, 90, 229, 20, 0, 7, 83, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 1, 0, 95, 222, 3, 143, 131, 131, 137, 183, 74, 55, 113,
				144, 138, 160, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 128, 225, 59,
				67, 38, 253, 149, 63, 46, 70, 139, 48, 185, 182 };
		for (int i = 0; i < jj3.rows * jj3.cols; i++) {
			ck_assert_int_eq(jj3.data[i], data_r4[i]);
		}

		matrix jj4;
		jj4.rows = 5;
		jj4.cols = 30;
		gf data_jj4[] = { 218, 170, 202, 110, 191, 160, 63, 201, 23, 200, 233,
				5, 115, 8, 113, 177, 226, 125, 106, 206, 120, 193, 26, 166, 196,
				73, 45, 103, 223, 47, 114, 65, 48, 116, 84, 220, 73, 8, 118, 35,
				162, 234, 199, 160, 7, 140, 253, 140, 188, 198, 65, 180, 254,
				244, 99, 203, 69, 0, 70, 207, 248, 172, 185, 9, 191, 163, 250,
				164, 52, 32, 74, 143, 161, 244, 137, 147, 220, 3, 249, 218, 209,
				174, 37, 147, 215, 209, 120, 23, 61, 219, 33, 251, 253, 194, 17,
				36, 45, 160, 160, 191, 222, 118, 219, 171, 130, 129, 212, 246,
				248, 199, 112, 130, 92, 55, 0, 5, 217, 228, 233, 128, 245, 70,
				193, 209, 74, 179, 200, 159, 68, 99, 212, 143, 214, 112, 107,
				88, 59, 181, 156, 4, 76, 64, 146, 12, 224, 37, 57, 165, 57, 96 };
		jj4.data = data_jj4;
		echelon_form(&jj4);
		gf data_r5[] = { 1, 0, 0, 0, 0, 162, 171, 219, 154, 244, 54, 35, 131,
				222, 141, 84, 71, 224, 39, 63, 20, 147, 44, 124, 197, 31, 209,
				218, 196, 143, 0, 1, 0, 0, 0, 197, 48, 114, 254, 222, 190, 45,
				0, 72, 9, 97, 118, 230, 2, 178, 212, 91, 195, 244, 251, 108,
				207, 80, 154, 226, 0, 0, 1, 0, 0, 85, 106, 47, 223, 111, 248,
				247, 10, 135, 164, 96, 206, 194, 91, 39, 104, 139, 78, 76, 230,
				113, 143, 119, 17, 166, 0, 0, 0, 1, 0, 240, 159, 78, 78, 53,
				189, 68, 199, 181, 160, 110, 70, 110, 219, 71, 233, 233, 171,
				133, 186, 217, 86, 23, 167, 247, 0, 0, 0, 0, 1, 5, 101, 118, 26,
				5, 207, 188, 74, 82, 9, 6, 105, 22, 148, 4, 98, 36, 181, 195,
				197, 50, 155, 147, 141, 201 };
		for (int i = 0; i < jj4.rows * jj4.cols; i++) {
			ck_assert_int_eq(jj4.data[i], data_r5[i]);
		}

		matrix jj5;
		jj5.rows = 5;
		jj5.cols = 50;
		gf data_jj5[] = { 116, 87, 100, 107, 163, 217, 176, 144, 24, 149, 69,
				187, 131, 81, 179, 23, 91, 145, 140, 182, 204, 85, 237, 123,
				146, 127, 73, 83, 13, 104, 159, 154, 243, 27, 101, 132, 27, 226,
				245, 100, 124, 110, 127, 245, 196, 229, 179, 192, 193, 244, 213,
				250, 224, 75, 190, 204, 73, 136, 9, 12, 216, 219, 189, 230, 212,
				169, 153, 133, 225, 189, 178, 146, 217, 179, 30, 105, 126, 44,
				58, 81, 113, 204, 148, 243, 122, 239, 14, 108, 185, 21, 30, 149,
				44, 50, 207, 107, 181, 161, 127, 99, 83, 230, 236, 107, 209,
				191, 201, 88, 140, 139, 78, 149, 151, 226, 161, 109, 25, 20, 13,
				2, 8, 87, 52, 192, 188, 176, 209, 104, 245, 3, 154, 162, 239,
				97, 88, 176, 167, 109, 13, 77, 249, 155, 222, 246, 213, 171, 56,
				90, 54, 22, 71, 69, 228, 133, 53, 24, 180, 45, 2, 43, 139, 161,
				63, 39, 161, 179, 202, 228, 157, 238, 207, 85, 181, 156, 100,
				103, 92, 194, 57, 33, 230, 96, 140, 94, 14, 86, 111, 132, 116,
				171, 167, 38, 87, 234, 201, 239, 101, 236, 42, 138, 165, 189,
				102, 62, 167, 101, 93, 55, 132, 98, 186, 37, 93, 226, 40, 38,
				82, 19, 226, 124, 18, 189, 99, 70, 165, 152, 165, 157, 90, 95,
				245, 151, 163, 63, 245, 61, 41, 174, 232, 93, 195, 138, 224,
				245, 252, 211, 98, 114, 217, 75 };
		jj5.data = data_jj5;
		echelon_form(&jj5);
		gf data_r6[] = { 1, 0, 0, 0, 0, 57, 216, 98, 176, 192, 226, 41, 159, 98,
				58, 20, 172, 26, 65, 1, 218, 95, 12, 3, 213, 124, 151, 64, 243,
				234, 238, 197, 118, 91, 187, 176, 182, 255, 169, 26, 145, 68,
				197, 175, 158, 246, 28, 160, 47, 3, 0, 1, 0, 0, 0, 204, 153,
				138, 83, 159, 118, 84, 208, 81, 82, 81, 96, 41, 73, 35, 238, 5,
				231, 177, 55, 194, 219, 48, 230, 240, 114, 108, 11, 190, 242,
				139, 195, 238, 27, 120, 14, 49, 255, 9, 204, 62, 115, 240, 30,
				213, 0, 0, 1, 0, 0, 88, 128, 61, 106, 4, 204, 184, 169, 54, 92,
				143, 136, 52, 253, 161, 58, 136, 4, 143, 188, 81, 108, 107, 188,
				221, 99, 30, 38, 151, 167, 23, 106, 210, 6, 5, 26, 129, 3, 129,
				128, 138, 68, 4, 69, 148, 0, 0, 0, 1, 0, 216, 150, 44, 64, 197,
				157, 172, 147, 120, 156, 246, 98, 170, 15, 250, 74, 26, 186, 14,
				151, 249, 210, 59, 90, 16, 244, 207, 140, 63, 49, 88, 90, 196,
				131, 16, 229, 207, 246, 3, 126, 205, 243, 243, 155, 245, 0, 0,
				0, 0, 1, 235, 122, 28, 249, 117, 157, 131, 140, 58, 5, 108, 156,
				30, 245, 77, 88, 110, 68, 123, 202, 27, 62, 156, 244, 218, 241,
				35, 129, 16, 51, 168, 175, 203, 117, 245, 76, 205, 104, 71, 10,
				198, 113, 185, 41, 117 };
		for (int i = 0; i < jj5.rows * jj5.cols; i++) {
			ck_assert_int_eq(jj5.data[i], data_r6[i]);
		}
	}END_TEST

START_TEST(transpose_matrix_test)
	{
		matrix g;
		g.rows = 10;
		g.cols = 10;
		gf data_g[] = { 31331, 52197, 30750, 22988, 21920, 50160, 56792, 20778,
				61888, 39333, 14998, 28639, 58045, 59226, 23147, 30686, 4097,
				20375, 36702, 20265, 7591, 34617, 20904, 41353, 60763, 61520,
				64096, 4238, 30913, 40529, 24229, 27558, 53641, 57784, 443,
				27151, 48884, 12413, 10607, 36603, 14505, 23563, 25868, 37774,
				3525, 12215, 13772, 15966, 10069, 14371, 45592, 65289, 7791,
				10335, 36270, 51009, 13021, 497, 64268, 5529, 7063, 42793, 1990,
				24178, 16745, 18805, 12996, 26029, 32274, 11144, 30593, 44659,
				60730, 11899, 43246, 53979, 55065, 31551, 32334, 28818, 6402,
				52292, 36256, 32384, 11891, 59255, 27117, 17197, 45825, 35675,
				50461, 34891, 53547, 16817, 45390, 9004, 21430, 38229, 11219,
				30477 };

		g.data = data_g;
		matrix *transposed = transpose_matrix(&g);
		gf data_compare[] = { 31331, 14998, 7591, 24229, 14505, 45592, 7063,
				30593, 6402, 50461, 52197, 28639, 34617, 27558, 23563, 65289,
				42793, 44659, 52292, 34891, 30750, 58045, 20904, 53641, 25868,
				7791, 1990, 60730, 36256, 53547, 22988, 59226, 41353, 57784,
				37774, 10335, 24178, 11899, 32384, 16817, 21920, 23147, 60763,
				443, 3525, 36270, 16745, 43246, 11891, 45390, 50160, 30686,
				61520, 27151, 12215, 51009, 18805, 53979, 59255, 9004, 56792,
				4097, 64096, 48884, 13772, 13021, 12996, 55065, 27117, 21430,
				20778, 20375, 4238, 12413, 15966, 497, 26029, 31551, 17197,
				38229, 61888, 36702, 30913, 10607, 10069, 64268, 32274, 32334,
				45825, 11219, 39333, 20265, 40529, 36603, 14371, 5529, 11144,
				28818, 35675, 30477 };

		for (int i = 0; i < transposed->rows * transposed->cols; i++) {
			ck_assert_int_eq(transposed->data[i], data_compare[i]);
		}
		free_matrix(transposed);

		matrix g2;
		g2.rows = 30;
		g2.cols = 10;
		gf data_g2[] = { 62185, 47753, 31515, 25799, 60547, 3082, 12067, 64788,
				52752, 60267, 23766, 57378, 14232, 21592, 47355, 9693, 20456,
				4471, 32193, 4105, 39457, 14057, 39975, 10998, 57146, 6533,
				59384, 19393, 20166, 12851, 3006, 9333, 13505, 12150, 5850,
				45685, 53274, 48348, 26488, 45230, 35764, 30040, 28115, 24505,
				58890, 20321, 12434, 41371, 60754, 31576, 60463, 10298, 35317,
				1467, 10413, 12280, 32635, 57019, 29607, 12260, 34536, 21549,
				48083, 12872, 16303, 43265, 31839, 4371, 21264, 4907, 18116,
				58749, 6487, 1719, 33383, 41656, 23311, 27042, 35770, 17338,
				41810, 19646, 47844, 33701, 34276, 34910, 4479, 28049, 60843,
				64946, 8068, 52957, 59941, 12220, 31410, 53459, 40063, 50542,
				44434, 23820, 1620, 52066, 30511, 21379, 22778, 60821, 12645,
				46845, 8349, 23596, 48572, 30286, 8671, 58566, 60600, 9588,
				34341, 31601, 37870, 32926, 44886, 39796, 36171, 2839, 10317,
				55862, 15642, 61444, 44277, 4782, 13391, 15635, 40023, 56149,
				34588, 6317, 29780, 7523, 46505, 24076, 45714, 62358, 13, 57089,
				40271, 31380, 63687, 53167, 12867, 42232, 15972, 51171, 15593,
				15169, 56040, 22199, 4348, 28756, 61454, 62261, 62115, 36853,
				3624, 323, 5539, 19611, 31626, 39124, 60392, 56402, 34359,
				37701, 18769, 9899, 29878, 39939, 40375, 58583, 34150, 31439,
				5876, 6662, 21592, 55568, 25488, 58252, 58446, 55128, 8652,
				31870, 1715, 49855, 2292, 60913, 61908, 33384, 12225, 45686,
				31499, 46453, 23861, 20098, 29910, 17702, 45977, 21885, 62999,
				52344, 13489, 15528, 13968, 53276, 58195, 50524, 25878, 51794,
				36879, 33333, 33133, 7141, 57664, 49668, 17204, 18357, 20710,
				28608, 11184, 53107, 4145, 45169, 15106, 57879, 12720, 4378,
				43420, 31798, 7226, 10882, 14076, 753, 5151, 11875, 50272,
				27200, 18242, 36680, 8107, 42940, 29288, 53405, 30515, 42283,
				37711, 13846, 7086, 7124, 46230, 16989, 50507, 23810, 12709,
				27139, 6568, 10407, 32752, 45362, 52686, 57294, 54680, 33851,
				27972, 39684, 9915, 59844, 46097, 39109, 1686, 46733, 53777,
				51167, 39844, 27688, 55638, 23454, 54121, 468, 35989, 18955,
				50006, 61257, 11904, 50081, 58368, 60902, 44159, 26463, 9417,
				21465, 44482, 43261 };

		g2.data = data_g2;
		transposed = transpose_matrix(&g2);
		gf data_compare2[] = { 62185, 23766, 39457, 3006, 35764, 60463, 34536,
				18116, 41810, 8068, 1620, 48572, 44886, 13391, 45714, 15972,
				62115, 34359, 5876, 1715, 23861, 13968, 57664, 15106, 5151,
				30515, 12709, 27972, 39844, 11904, 47753, 57378, 14057, 9333,
				30040, 10298, 21549, 58749, 19646, 52957, 52066, 30286, 39796,
				15635, 62358, 51171, 36853, 37701, 6662, 49855, 20098, 53276,
				49668, 57879, 11875, 42283, 27139, 39684, 27688, 50081, 31515,
				14232, 39975, 13505, 28115, 35317, 48083, 6487, 47844, 59941,
				30511, 8671, 36171, 40023, 13, 15593, 3624, 18769, 21592, 2292,
				29910, 58195, 17204, 12720, 50272, 37711, 6568, 9915, 55638,
				58368, 25799, 21592, 10998, 12150, 24505, 1467, 12872, 1719,
				33701, 12220, 21379, 58566, 2839, 56149, 57089, 15169, 323,
				9899, 55568, 60913, 17702, 50524, 18357, 4378, 27200, 13846,
				10407, 59844, 23454, 60902, 60547, 47355, 57146, 5850, 58890,
				10413, 16303, 33383, 34276, 31410, 22778, 60600, 10317, 34588,
				40271, 56040, 5539, 29878, 25488, 61908, 45977, 25878, 20710,
				43420, 18242, 7086, 32752, 46097, 54121, 44159, 3082, 9693,
				6533, 45685, 20321, 12280, 43265, 41656, 34910, 53459, 60821,
				9588, 55862, 6317, 31380, 22199, 19611, 39939, 58252, 33384,
				21885, 51794, 28608, 31798, 36680, 7124, 45362, 39109, 468,
				26463, 12067, 20456, 59384, 53274, 12434, 32635, 31839, 23311,
				4479, 40063, 12645, 34341, 15642, 29780, 63687, 4348, 31626,
				40375, 58446, 12225, 62999, 36879, 11184, 7226, 8107, 46230,
				52686, 1686, 35989, 9417, 64788, 4471, 19393, 48348, 41371,
				57019, 4371, 27042, 28049, 50542, 46845, 31601, 61444, 7523,
				53167, 28756, 39124, 58583, 55128, 45686, 52344, 33333, 53107,
				10882, 42940, 16989, 57294, 46733, 18955, 21465, 52752, 32193,
				20166, 26488, 60754, 29607, 21264, 35770, 60843, 44434, 8349,
				37870, 44277, 46505, 12867, 61454, 60392, 34150, 8652, 31499,
				13489, 33133, 4145, 14076, 29288, 50507, 54680, 53777, 50006,
				44482, 60267, 4105, 12851, 45230, 31576, 12260, 4907, 17338,
				64946, 23820, 23596, 32926, 4782, 24076, 42232, 62261, 56402,
				31439, 31870, 46453, 15528, 7141, 45169, 753, 53405, 23810,
				33851, 51167, 61257, 43261 };

		for (int i = 0; i < transposed->rows * transposed->cols; i++) {
			ck_assert_int_eq(transposed->data[i], data_compare2[i]);
		}
		free_matrix(transposed);

		matrix g3;
		g3.rows = 5;
		g3.cols = 45;
		gf data_g3[] = { 16867, 51264, 9476, 26097, 29198, 39385, 23387, 47007,
				30256, 28095, 18056, 15938, 48465, 7043, 48580, 20225, 51559,
				18313, 23778, 44893, 38054, 17049, 5915, 30377, 56540, 29978,
				51730, 10691, 24150, 36665, 44526, 11893, 10288, 57134, 34821,
				22464, 55904, 61436, 9796, 20060, 1156, 22101, 52163, 53398,
				65025, 51828, 8255, 56380, 18260, 25014, 15028, 19408, 57457,
				44757, 4176, 28212, 11893, 58182, 20675, 60846, 63382, 20138,
				64289, 39764, 54862, 38863, 13401, 38326, 13765, 43038, 46737,
				62981, 49755, 2627, 55126, 34211, 3050, 27772, 37569, 9060,
				29571, 61857, 21258, 63267, 23281, 45238, 4444, 11926, 65123,
				34615, 24104, 52674, 7769, 48166, 19475, 11262, 62851, 40569,
				27681, 44480, 51982, 41540, 29925, 3306, 10641, 32933, 40933,
				21439, 14654, 40103, 1001, 15001, 31137, 14800, 40027, 780,
				65300, 41143, 42786, 58696, 36483, 23313, 40548, 61193, 18684,
				28154, 23345, 35198, 61114, 39048, 65387, 4712, 45438, 31365,
				55716, 34487, 51301, 65192, 244, 61333, 55913, 62661, 40965,
				65099, 50175, 51244, 53243, 16520, 7529, 36012, 42943, 40962,
				29583, 43111, 26212, 43139, 30834, 59603, 20366, 51352, 33154,
				2261, 36707, 5367, 2268, 7201, 51280, 47599, 37479, 49814,
				33036, 27156, 62681, 46325, 36006, 9938, 57765, 45754, 50267,
				14067, 26803, 12684, 23158, 15727, 13473, 1794, 23668, 64921,
				52565, 38779, 43346, 56269, 2746, 32385, 38526, 63250, 25375,
				1521, 34552, 13232, 28196, 43374, 57902, 53709, 50667, 27350,
				26346, 64556, 31464, 19471, 6285, 58102, 7599, 39231, 56625,
				10830, 48916, 55345, 39064, 18563, 43838, 61771, 4201, 14006,
				9134 };

		g3.data = data_g3;
		transposed = transpose_matrix(&g3);
		gf data_compare3[] = { 16867, 51828, 24104, 34487, 26803, 51264, 8255,
				52674, 51301, 12684, 9476, 56380, 7769, 65192, 23158, 26097,
				18260, 48166, 244, 15727, 29198, 25014, 19475, 61333, 13473,
				39385, 15028, 11262, 55913, 1794, 23387, 19408, 62851, 62661,
				23668, 47007, 57457, 40569, 40965, 64921, 30256, 44757, 27681,
				65099, 52565, 28095, 4176, 44480, 50175, 38779, 18056, 28212,
				51982, 51244, 43346, 15938, 11893, 41540, 53243, 56269, 48465,
				58182, 29925, 16520, 2746, 7043, 20675, 3306, 7529, 32385,
				48580, 60846, 10641, 36012, 38526, 20225, 63382, 32933, 42943,
				63250, 51559, 20138, 40933, 40962, 25375, 18313, 64289, 21439,
				29583, 1521, 23778, 39764, 14654, 43111, 34552, 44893, 54862,
				40103, 26212, 13232, 38054, 38863, 1001, 43139, 28196, 17049,
				13401, 15001, 30834, 43374, 5915, 38326, 31137, 59603, 57902,
				30377, 13765, 14800, 20366, 53709, 56540, 43038, 40027, 51352,
				50667, 29978, 46737, 780, 33154, 27350, 51730, 62981, 65300,
				2261, 26346, 10691, 49755, 41143, 36707, 64556, 24150, 2627,
				42786, 5367, 31464, 36665, 55126, 58696, 2268, 19471, 44526,
				34211, 36483, 7201, 6285, 11893, 3050, 23313, 51280, 58102,
				10288, 27772, 40548, 47599, 7599, 57134, 37569, 61193, 37479,
				39231, 34821, 9060, 18684, 49814, 56625, 22464, 29571, 28154,
				33036, 10830, 55904, 61857, 23345, 27156, 48916, 61436, 21258,
				35198, 62681, 55345, 9796, 63267, 61114, 46325, 39064, 20060,
				23281, 39048, 36006, 18563, 1156, 45238, 65387, 9938, 43838,
				22101, 4444, 4712, 57765, 61771, 52163, 11926, 45438, 45754,
				4201, 53398, 65123, 31365, 50267, 14006, 65025, 34615, 55716,
				14067, 9134 };

		for (int i = 0; i < transposed->rows * transposed->cols; i++) {
			ck_assert_int_eq(transposed->data[i], data_compare3[i]);
		}
		free_matrix(transposed);

	}END_TEST
#endif

Suite * matrix_suite(void) {
	Suite *s;
	TCase *tc_core;

	s = suite_create("MATRIX_DAGS");

	/* Core test case */
	tc_core = tcase_create("matrix_suite");

	tcase_add_test(tc_core, make_matrix_test);
	tcase_add_test(tc_core, augment_matrix_test);
	tcase_add_test(tc_core, echelon_form_test);
	tcase_add_test(tc_core, transpose_matrix_test);
	suite_add_tcase(s, tc_core);

	return s;
}

#endif
